\documentclass[11pt]{report}
\usepackage{srcltx}
\usepackage{xcolor}
%\usepackage[color]{showkeys}
\usepackage{graphicx}
%\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{theorem}
\usepackage{euscript}
\usepackage{stmaryrd}
%\usepackage{kpfonts}
\usepackage{epic,eepic}
\usepackage{pstricks}
\usepackage{enumitem} 
\usepackage{parskip}
\usepackage{hyperref}
\usepackage{cleveref}
%\usepackage{tikz,pgfplots}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{color}
\usepackage{multirow}
\usepackage{float}
\usepackage{multirow, array}
\usepackage{booktabs}
\usepackage{mathrsfs}
\usepackage{mathdots}
\usepackage{stackrel}
\usepackage{relsize}
\usepackage{ dsfont }
\usepackage{listings}
\usepackage{color}
\usepackage{graphicx}
\usepackage{setspace} 
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{theorem}
\usepackage{euscript}
\usepackage{epic,eepic}
\usepackage{pstricks}
\usepackage{blindtext}
\usepackage[english]{babel}
%\usepackage[spanish]{babel}
%\usepackage[T1]{fontenc}
%\usepackage[color]{showkeys}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{theorem}
\usepackage{euscript}
\usepackage{epic,eepic}
\usepackage{pstricks}
\usepackage{epstopdf}
\usepackage{mathtools}
\usepackage{afterpage}

\usepackage{parskip}
\usepackage{tikz}
\usepackage{multirow}
\usepackage{float}
\usepackage{multirow, array}
\usepackage{booktabs}
\usepackage{mathrsfs}
\usepackage{mathdots}
\usepackage{stackrel}
\usepackage{cite}
\usepackage{fancybox, calc}
\usepackage{verbatim}
\usepackage{fancyhdr}
\usepackage{subfigure}
\usepackage{verbatim}
\usepackage{color}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\lstset{ 
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}; should come as last argument
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  firstnumber=1,                % start line enumeration with line 1000
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  language=Octave,                 % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,	                   % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}
%\RequirePackage[colorlinks,hyperindex]{hyperref}
%\hypersetup{
 %   linktocpage=true,
  %  citecolor=dblue,    % color can be changed!
   % linkcolor=dgreen,
    %urlcolor=blue% color can be changed!
%}
%-------------------------------------------------------------------------
\topmargin -0.7cm
\oddsidemargin -0.1cm
\textwidth  16.6cm 
\headheight 0.0cm
\textheight 22.6cm
\parindent  5mm
\parskip    8pt
\tolerance  1000
\definecolor{labelkey}{rgb}{0,0.08,0.45}
\definecolor{refkey}{rgb}{0,0.6,0.0}
\definecolor{Brown}{rgb}{0.45,0.0,0.05}
\definecolor{dgreen}{rgb}{0.00,0.49,0.00}
\definecolor{dblue}{rgb}{0,0.08,0.75}
%-------------------------------------------------------------------------
\DeclareSymbolFont{largesymbolsA}{U}{jkpexa}{m}{n}
\SetSymbolFont{largesymbolsA}{bold}{U}{jkpexa}{bx}{n}
\DeclareMathSymbol{\varprod}{\mathop}{largesymbolsA}{16}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
\author{Cristian Vega}
\title{\sffamily Alternating and randomized projections on convex optimization
\footnote{Contact author: 
Cristian Vega Cere\~no, {\ttfamily cristian.vega.14@sansano.usm.cl},
}}
\author{Cristian Vega$^1$ 
\\[5mm]
\small $\!^1$Universidad T\'ecnica Federico Santa Mar\'ia\\
\small Departamento de Matem\'atica\\
}

\date{\ttfamily \today}
\tolerance 2500
%--------------------------------- HYPERLINKS -----------------------------
%\RequirePackage[dvipdfm,colorlinks,hyperindex]{hyperref}
%% http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=hyperref
%\hypersetup{
%    linktocpage=true,
%    citecolor=dblue,    % color can be changed!
%    linkcolor=dgreen    % color can be changed!
%}
%--------------------------------------------------------------------------
\newcommand{\Frac}[2]{\displaystyle{\frac{#1}{#2}}} 
\newcommand{\Scal}[2]{{\bigg\langle{{#1}\:\bigg |~{#2}}\bigg\rangle}}
\newcommand{\scal}[2]{{\left\langle{{#1}\mid{#2}}\right\rangle}}
\newcommand{\pscal}[2]{\langle\langle{#1}\mid{#2}\rangle\rangle} 
\newcommand{\Menge}[2]{\Big\{{#1}~\big |~{#2}\Big\}} 
\newcommand{\menge}[2]{\big\{{#1}~\big |~{#2}\big\}} 
\newcommand{\moyo}[2]{\ensuremath{\sideset{^{#2}}{}{\operatorname{}}\!\!#1}}
\newcommand{\X}{\ensuremath{{\mathcal X}}}
\newcommand{\XX}{\ensuremath{{\mathcal X}}}
\newcommand{\HH}{\ensuremath{{\mathcal H}}}
\newcommand{\HHH}{\ensuremath{\boldsymbol{\mathcal H}}}
\newcommand{\GGG}{\ensuremath{\boldsymbol{\mathcal G}}}
\newcommand{\YYY}{\ensuremath{\boldsymbol{\mathcal Y}}}
\newcommand{\ZZZ}{\ensuremath{\boldsymbol{\mathcal Z}}}
\newcommand{\LLL}{\ensuremath{\boldsymbol{\mathcal L}}}
\newcommand{\GG}{\ensuremath{{\mathcal G}}}
\newcommand{\SSS}{\ensuremath{{\mathcal S}}}
\newcommand{\BL}{\ensuremath{\EuScript B}\,}
\newcommand{\SP}{\ensuremath{{\mathcal S}_+}}
\newcommand{\emp}{\ensuremath{{\varnothing}}}
\newcommand{\spn}{\ensuremath{\operatorname{span}}}
\newcommand{\lev}[1]{{\ensuremath{{{{\operatorname{lev}}}_{\leq #1}}\,}}}
\newcommand{\nabli}[1]{\nabla_{\!{#1}}\,}
\newcommand{\Id}{\ensuremath{\operatorname{Id}}\,}
\newcommand{\RR}{\ensuremath{\mathbb{R}}}
\newcommand{\CC}{\ensuremath{\mathbb{C}}}
\newcommand{\ran}{\ensuremath{\operatorname{ran}}}
\newcommand{\haus}{\ensuremath{\operatorname{haus}}}
\newcommand{\bre}{\ensuremath{\operatorname{R}}}
\newcommand{\bdry}{\ensuremath{\operatorname{bdry}}}
\newcommand{\RP}{\ensuremath{\left[0,+\infty\right[}}
\newcommand{\RM}{\ensuremath{\left]-\infty,0\right]}}
\newcommand{\RMM}{\ensuremath{\left]-\infty,0\right[}}
\newcommand{\RPP}{\ensuremath{\left]0,+\infty\right[}}
\newcommand{\RPPX}{\ensuremath{\left]0,+\infty\right]}}
\newcommand{\RPX}{\ensuremath{\left[0,+\infty\right]}}
\newcommand{\RNX}{\ensuremath{\left[-\infty,0\right]}}
\newcommand{\RXX}{\ensuremath{\left[-\infty,+\infty\right]}}
\newcommand{\RX}{\ensuremath{\left]-\infty,+\infty\right]}}
\newcommand{\XR}{\ensuremath{\left[-\infty,+\infty\right[}}
\newcommand{\NN}{\ensuremath{\mathbb N}}
\newcommand{\OO}{\ensuremath{\mathcal O}}
\newcommand{\rr}{\ensuremath{\mathcal R}}
\newcommand{\ind}{\ensuremath{\mathbb 1}}
\newcommand{\KK}{\ensuremath{\mathbb K}}
\newcommand{\JJ}{\ensuremath{\mathbb J}}
\newcommand{\II}{\ensuremath{\mathbb I}}
\newcommand{\LL}{\ensuremath{\mathbb L}}
\newcommand{\cart}{\ensuremath{\raisebox{-0.5mm}
{\mbox{\LARGE{$\times$}}}}\!}
\newcommand{\ZZ}{\ensuremath{\mathbb Z}}
\newcommand{\gr}{\ensuremath{\operatorname{gra}}}
\newcommand{\exi}{\ensuremath{\exists\,}}
\newcommand{\pinf}{\ensuremath{{+\infty}}}
\newcommand{\minf}{\ensuremath{{-\infty}}}
\newcommand{\weakly}{\ensuremath{\:\rightharpoonup\:}}
\newcommand{\argmin}{\ensuremath{\operatorname{argmin}}}
\newcommand{\Argmin}{\ensuremath{\operatorname{Argmin}}}
\newcommand{\argmax}{\ensuremath{\operatorname{argmax}}}
\newcommand{\Argmax}{\ensuremath{\operatorname{Argmax}}}
\newcommand{\Fix}{\ensuremath{\operatorname{Fix}}}
\newcommand{\dom}{\ensuremath{\operatorname{dom}}}
\newcommand{\prox}{\ensuremath{\operatorname{prox}}}
\newcommand{\soft}[1]{\ensuremath{{\operatorname{soft}}_{{#1}}\,}}
\newcommand{\card}{\ensuremath{\operatorname{card}}}
\newcommand{\minim}{\ensuremath{\operatorname{Minimize}}}
\newcommand{\sign}{\ensuremath{\operatorname{sign}}}
\newcommand{\sri}{\ensuremath{\operatorname{sri}}}
\newcommand{\inte}{\ensuremath{\operatorname{int}}}
\newcommand{\infconv}{\ensuremath{\mbox{\small$\,\square\,$}}}
\newcommand{\zeroun}{\ensuremath{\left]0,1\right[}}   
\newcommand{\ddp}[1]{{f}_{#1}}
\newcommand{\vertiii}[1]{{\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert #1 
    \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}}
\newcommand{\normi}{\vert\kern-0.25ex\vert\kern-0.25ex\vert}
\newcommand\blankpage{%
    \null
    \thispagestyle{empty}%
    \addtocounter{page}{-1}%
    \newpage}
\renewcommand{\abstractname}{Abstract}
%-------------------------------------------------------------------------
\def\proof{\noindent{\it Proof}. \ignorespaces}
\def\endproof{\vbox{\hrule height0.6pt\hbox{\vrule height1.3ex% 
width0.6pt\hskip0.8ex\vrule width0.6pt}\hrule height0.6pt}}
%-------------------------------------------------------------------------
\ProvideTextCommand{\DJ}{OT1}{\raisebox{0.25ex}{-}\kern-0.4em D}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{example}[theorem]{Example}
\theoremstyle{plain}{\theorembodyfont{\rmfamily}%
\newtheorem{assumption}[theorem]{Assumption}}
\theoremstyle{plain}{\theorembodyfont{\rmfamily}%
\newtheorem{algorithm}[theorem]{Algorithm}}
\theoremstyle{plain}{\theorembodyfont{\rmfamily}%
\newtheorem{example}[theorem]{Example}}
\theoremstyle{plain}{\theorembodyfont{\rmfamily}%
\newtheorem{remark}[theorem]{Remark}}
\theoremstyle{plain}{\theorembodyfont{\rmfamily}%
\newtheorem{definition}[theorem]{Definition}}
\theoremstyle{plain}{\theorembodyfont{\rmfamily}%
\newtheorem{problem}[theorem]{Problem}}
\renewcommand\theenumi{(\roman{enumi})}
\renewcommand\theenumii{(\alph{enumii})}
\renewcommand{\labelenumi}{\rm (\roman{enumi})}
\renewcommand{\labelenumii}{\rm (\alph{enumii})}
\numberwithin{equation}{chapter}
\newcommand{\dal}{u} 
\newcommand{\prim}{x} 
\newcommand{\proj}{p} 
\newcommand{\Dal}{U} 
\newcommand{\Prim}{X} 
\newcommand{\Proj}{P}  
%-------------------------------------  ------------------------------------
\begin{document}
\chapter{Randomized BA} 
 \begin{problem}
\label{problema 1}
Let $A\in\RR^{d\times p}$ and $b\in\RR^p$. For every $i\in I:=\{1,\dots,N\}$, let  $\{B_{k}\}_{i=1}^{N}\in\RR^{p\times d}$. $b\in\RR^p$. The problem is to find $\bar{x}\in \RR^{p}$ such that
\begin{align}
    (\forall i\in I)\hspace{3mm} \bar{x}\in S_i:=\{x\in \RR^{p}\mid B_i Ax=B_i b\},
\end{align}
under the assumption that $S:=\bigcap_{i\in I}S_{i}\neq\emptyset$\\ \\
We refer to the modified algorithm as the random iteration of BA, which guarantees the convergence of the iterations for a appropriate choice of the parameter $\alpha$:
 \begin{align}
    x^{k+1}=x^{k}+\alpha_{\xi_{k}}B_{\xi_{k}}\left(b-Ax^k\right)
    \label{A: BAM}
\end{align}
where $\left(\xi_{k}\right)_{k=1}^{\infty}$ is a familily of i.i.d.  $S$-valued random variables.\\ \\For every $i\in I$, define $C_{i}=B_{i}A$ and $T_{i}=\Id-\alpha_{i}C_{i}$. Then the iteration matrix  \eqref{A: BAM} is equal to:
\begin{align}
    x^{k+1}=T_{\xi_{k}}x^{k}+\alpha_{\xi_{k}} B_{\xi_{k}}b.
    \label{A: BAM-Operator}
\end{align}
Moreover, assume that 
\begin{align}\begin{tabular}{lll}
    $T\colon$ &$\RR^{p}\times I$&$\mapsto \RR^{p}$\nonumber\\
    & $(x,i)$&$\mapsto x+\alpha_{i}B_{i}\left(b-Ax\right)$
\end{tabular}
\end{align}
is measurable.
\\ \\ This scheme is motivated by the following problem,
\begin{align}
    \bar{x}:=\argmin_{x\in\RR^{p}}\{\|Ax-b\|^2\}=(A^{T}A)^{-1}A^{T}b
\end{align}
\end{problem}
\begin{theorem}\label{T:Convergence} Let $x_0\in\RR^{p}$. For every $i\in I$, let $\alpha_i$ the stepsize, such that 
    \begin{align}
        (\forall i\in I)\hspace{3mm} 2\alpha_{i}C_i-\alpha^{2}_{i}C^{T}_{i}C_{i}\hspace{3mm}\text{ is positive semidefinite.}
        \label{c: conditionlambda}
    \end{align}
    Then the sequence generated by Random BA iteration \eqref{A: BAM-Operator}  converges almost surely to a $S$-valued random variable.
\end{theorem} 
\begin{proof}
  Let $\bar{x}\in S_i$ and $x\not\in S_i $
    \begin{align}
        \|Tx-\bar{x}\|^2=&\|x-\bar{x}\|^2-2\alpha_{i}\scal{B_{i}\left(b-Ax^k\right)}{x-\bar{x}}+\alpha_{i}^{2}\|B_{i}\left(b-Ax^k\right)\|^{2}\nonumber\\=&\|x-\bar{x}\|^2-2\alpha_{i}\scal{B_{i}A\left(\bar{x}-x^k\right)}{x-\bar{x}}+\alpha_{i}^{2}\|B_{i}A\left(x^k-\bar{x}\right)\|^{2}\nonumber\\=&\|x-\bar{x}\|^2-\scal{2\alpha_{i}C_i\left(\bar{x}-x^k\right)}{x-\bar{x}}+\scal{\alpha_{i}^{2}C^{T}_{i}C_i\left(x^k-\bar{x}\right)}{x^k-\bar{x}}\nonumber\\=&\|x-\bar{x}\|^2-\scal{(2\alpha_{i}C_i-\alpha^{2}_{i}C^{T}_{i}C_{i})\left(\bar{x}-x^k\right)}{x-\bar{x}}\nonumber\\<&\|x-\bar{x}\|^2,
    \end{align}
and for every $i\in I$  $T_i$ is paracontractive and the result follows from \cite[Theorem 3.6]{Russell}
\end{proof}
\begin{theorem}\label{T:Convergence1} Let $x_0\in\RR^{p}$. For every $i\in I$, let $\alpha_i$ the stepsize and  let $p_{i}=\mathbb{P}(\xi^{-1}(i))>0$, such that 
    \begin{align}
        \rho(\Id-\sum_{i\in I}(p_iw_iB_{i}A))<1
        \label{c: conditionlambda1}
    \end{align}
    Then, for every $\bar{x}\in S$ \begin{align}
        \mathbb{E}(x^{k}-\bar{x})\rightarrow 0\hspace{2mm}\text{ and }\hspace{2mm}k\rightarrow 0
    \end{align}
\end{theorem} 
\begin{proof}
    Let $\bar{x}\in S$ and $k\in\NN$. It follows from \eqref{A: BAM} that
    \begin{align}
        \mathbb{E}(x^{k+1}-\bar{x})&=x^{k}-\bar{x}-\sum_{i\in I}p_{i}w_{i}B_i(A_ix^{k}-b)\nonumber\\&=x^{k}-\bar{x}-\sum_{i\in I}p_{i}w_{i}B_iA(x^{k}-\bar{x})\nonumber\\&=\left(\Id-\sum_{i\in I}(p_iw_iB_{i}A)\right)(x^{k}-\bar{x})\nonumber\\&=\left(\Id-\sum_{i\in I}(p_iw_iB_{i}A)\right)^{k+1}(x^{0}-\bar{x})
    \end{align}
\end{proof}
\begin{remark}We explore different instances of this method\\
    \begin{itemize}
    \item  If $N=1$ and $B_1=A^{T}$ we have that $C=A^{T}A$ and
    \begin{align}
        2\alpha x^{T}A^{T}Ax-\alpha^{2}x^{T}C^{T}Cx=2\alpha \|Ax\|^{2}-\alpha^{2}\|A^{T}Ax\|^{2}\geq (2\alpha -\alpha^{2}\|A\|^2)\|Ax\|^{2},
    \end{align}
 which is positive if $\alpha\in]0,\frac{2}{\|A\|^2}[$.
 Then \eqref{A: BAM}  is reduced to the method proposed in  \cite{Landweber} and
 its convergence is deduced from Theorem~\ref{T:Convergence}. 
\end{itemize}
\end{remark}
\begin{thebibliography}{99}
    \setlength{\itemsep}{1pt}
    \bibitem{Russell}
    {\sc N. Hermer, L.D. Russell, and A. Sturm}, {\it Random Function Iterations for Consistent
    Stochastic Feasibility} 2019.
    \bibitem{Landweber} 
 H. W. Engl, M. Hanke, and A. Neubauer. Regularization of Inverse Problems (Mathematics and its Applications).  Dordrecht, The Netherlands: Springer, vol. 375, 1996.
    \bibitem{Livre1} 
    {\sc H. H. Bauschke and P. L. Combettes,}
    {\em Convex Analysis and Monotone Operator Theory in Hilbert Spaces.}2nd edn. Springer, New York (2017).
    \end{thebibliography}
\end{document}